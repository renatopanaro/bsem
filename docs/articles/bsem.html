<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>bsem • bsem</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="bsem">
<meta property="og:description" content="bsem">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bsem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bsem.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rvpanaro/bsem/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bsem_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="bsem_files/vis-4.20.1/vis.css" rel="stylesheet">
<script src="bsem_files/vis-4.20.1/vis.min.js"></script><script src="bsem_files/visNetwork-binding-2.0.9/visNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>bsem</h1>
            <h3 class="subtitle">An R package for Bayesian structural equation modeling</h3>
                        <h4 class="author">R.V. Panaro</h4>
            <address class="author_afil">
      Universidade de São Paulo - USP<br><a class="author_email" href="mailto:#"></a><a href="mailto:renatovp@ime.usp.br" class="email">renatovp@ime.usp.br</a>
      </address>
                              <h4 class="author">V.D. Mayrink</h4>
            <address class="author_afil">
      Universidade de Federal de Minas Gerais - UFMG<br><a class="author_email" href="mailto:#"></a><a href="mailto:vdinizm@gmail.com" class="email">vdinizm@gmail.com</a>
      </address>
                  
            <h4 class="date">2020-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rvpanaro/bsem/blob/master/vignettes/bsem.Rmd"><code>vignettes/bsem.Rmd</code></a></small>
      <div class="hidden name"><code>bsem.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette describes the first instructions on how to fit the particular cases of structural equation models (SEMs) using the <code>bsem</code> package. Examples include confirmatory factor analysis (CFA) and confirmatory SEM. The flexible full SEM model (outer model + inner model), provided here, enables the evaluation of user-defined constructs (latent variables) along with the analysis of established relationships among the latent scores (estimates). In addition to this vignette, you can have access to Bayesian factor analysis instructions in <a href="https://projecteuclid.org/DPubS?service=UI&amp;version=1.0&amp;verb=Display&amp;handle=euclid.aoas/1372338468">Mayrink and Lucas</a> (2013) and <a href="https://projecteuclid.org/euclid.bjps/1414674773">Mayrink and Lucas</a> (2015) .</p>
<p>Consider:</p>
<ul>
<li><p>the outer model as: <span class="math display">\[\boldsymbol{X_{p\times n}} = \boldsymbol{\alpha}_{p\times k}\boldsymbol{\lambda}_{k\times n} +\boldsymbol{\varepsilon}_{p\times n}\]</span> where <span class="math inline">\(\boldsymbol{X}\)</span> is the standardized data matrix with the variables in the rows and observations in columns, <span class="math inline">\(\boldsymbol{\alpha}_{p\times j}\)</span> is the column vector of constant effects (loadings) for the <span class="math inline">\(j^{th}\)</span> latent variable and <span class="math inline">\(\boldsymbol{\lambda}_{j\times n}\)</span> is the row vector of scores for the <span class="math inline">\(j^{th}\)</span> unobserved variable<span class="math inline">\(,~j =1,\dots,k\)</span>. Normality is assumed for the errors as <span class="math inline">\(\boldsymbol{\varepsilon}_{p\times i}\sim N(\boldsymbol{0}, \boldsymbol{\Sigma}_{p\times p}), ~i = 1,\dots, n\)</span>, where the covariance is diagonal <span class="math inline">\(\boldsymbol{\Sigma} = (\sigma_1^2, \sigma_2^2, \dots,\sigma_p^2) \boldsymbol{I_p}\)</span>.</p></li>
<li><p>the inner model as: <span class="math display">\[\boldsymbol{\lambda}_{j\times n} = \boldsymbol{\beta}^{\top} {\lambda^{(-j)}}  + \nu~\]</span> where <span class="math inline">\(\boldsymbol{\beta}\)</span> is a column vector of constant coefficients, <span class="math inline">\({\lambda^{(-j)}}_{ k-1\times n}\)</span> is the matrix of scores excluding the <span class="math inline">\(j^{th}\)</span> row scores and the error assumes <span class="math inline">\(\nu\sim N(0,1)\)</span>.</p></li>
</ul>
<p>The guidelines in this document were divided into 5 subsequent sections: <a href="#installation">installation</a>, <a href="#description">description</a>, <a href="#usage">usage</a>, <a href="#graphical-analysis">graphical analysis</a>, and <a href="#remarks">remarks</a>.</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>The <code>bsem</code> package imports <code>Stan</code> software specific routines to support internal calculations. The <a href="https://mc-stan.org/users/interfaces/rstan"><code>rstan</code></a> package interface enables the use of NUTS algorithm ( <a href="http://www.stat.columbia.edu/~gelman/research/published/nuts.pdf">Hoffman and Gelman, 2014</a>) to explore the posterior distribution efficiently in R. The development version of <code>bsem</code> can be found in <a href="https://github.com/rvpanaro/bsem">github.com/rvpanaro/bsem</a>.</p>
<p>For github version:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"devtools"</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"rvpanaro/bsem"</span>)</pre></body></html></div>
<p>For CRAN version:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"devtools"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"bsem"</span>)</pre></body></html></div>
<p>During the installation, other dependencies might be required, such as <code>lattice</code>, <code>viridis</code>, <code>coda</code>, <code>DiagrammeR</code>, <code>visNetwork</code> and, obviously, <code>rstan</code>. Other packages are also suggested such as <code>ggplot2</code>, <code>bayesplot</code> and <code>tidybayes</code>. The default arguments used to build the <code><a href="../reference/sem.html">bsem::sem</a></code> routine will be introduced in the next sections this function is the main function of this package, as it allows the Bayesian analysis for SEM and its particular cases.</p>
</div>
<div id="description" class="section level1">
<h1 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h1>
<p>The data and additional commands are passed through the <code><a href="../reference/sem.html">bsem::sem</a></code> function as:</p>
<ul>
<li>
<code>data</code>: a mandatory ‘matrix’ object where the columns are variables and the rows are observations</li>
<li>
<code>paths</code>: a list of characters referring to the scores relationship (inner model); list elements must be named according to <code>blocks</code>
</li>
<li>
<code>blocks</code>: a list indicating the variables that might express relationship to the latent variables assigned (outer model); latent variables must be named</li>
<li>
<code>signals</code>: a list indicating the variables that might express relation to the latent variable assigned (outer model)</li>
<li>
<code>row_names</code>: identifier for each set of variables (observation = row); optional</li>
<li>
<code>prior_specs</code>: prior specification for the error variance <code>sigma2</code> and regression coefficients <code>beta</code>
</li>
<li>
<code>cores</code>: number of core threads to be used; arbitrary, however the quantity of cores in use does not exceed the number of chains</li>
<li>
<code>pars</code>: character vector with the names of the parameters to be considered after fitting; “alpha” refers to the loadings, “lambda” to the scores, “sigma2” to the errors, “Xna” to missing data, “log_lik” to the log likelihood summation</li>
<li>
<code>iter</code>: number of MCMC iterations</li>
<li>
<code>chains</code>: number of chains considering distinct initial values</li>
<li>
<code>scaled</code>: logical; whether to <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> the data set passed to the <code>data</code> argument</li>
<li>
<code>...</code>: further arguments passed to <code><a href="https://rdrr.io/pkg/rstan/man/stanmodel-method-sampling.html">rstan::sampling</a></code> such as <code>warmup</code>, <code>control</code>
</li>
</ul>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span>(<span class="no">data</span>,
           <span class="no">paths</span>,
           <span class="no">blocks</span>,
           <span class="no">signals</span>,
           <span class="kw">row_names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">data</span>),
           <span class="kw">prior_specs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">coef</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal(0,1)"</span>),
                         <span class="kw">error_var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"inv_gamma(2.1, 1.1)"</span>)),
           <span class="kw">cores</span> <span class="kw">=</span>  <span class="kw pkg">parallel</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>(),
           <span class="kw">pars</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"alpha"</span>, <span class="st">"lambda"</span>, <span class="st">"sigma2"</span>, <span class="st">"Xna"</span>),
           <span class="kw">iter</span> <span class="kw">=</span> <span class="fl">2000</span>,
           <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">4</span>,
           <span class="kw">scaled</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
          <span class="no">...</span>)</pre></body></html></div>
<p>The above function automatically selects the appropriate routine according to the specified arguments, examples are given in the next section. One can reproduce the examples bellow by copying and pasting the following code to the <code>R</code> console. For these examples, simulated artificial data was created so that we can verify that the estimates are close enough to the true parameter values used to generate the data.</p>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>This section describes how the package can be used to estimate artificial parameters. This is a former analysis in light of other studies based on replication such as Monte Carlo simulation study methods.</p>
<div id="uni-factor-cfa" class="section level2">
<h2 class="hasAnchor">
<a href="#uni-factor-cfa" class="anchor"></a>Uni-factor CFA</h2>
<p>This example is based on the uni-factor model ( <a href="https://journals.sagepub.com/doi/abs/10.3102/10769986004003207">Reckase</a>, 1979).</p>
<ul>
<li>The number of variables (columns), observations (rows) and latent variables to be simulated are defined:</li>
</ul>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">Nv</span> <span class="kw">&lt;-</span> <span class="fl">8</span>; <span class="no">Ne</span> <span class="kw">&lt;-</span> <span class="fl">30</span>; <span class="no">K</span> <span class="kw">&lt;-</span> <span class="fl">1</span></pre></body></html></div>
<ul>
<li>A list object <code>B</code> is necessary to represent each block that indicates which manifest variables are related to each construct:</li>
</ul>
<div class="sourceCode" id="cb5"><html><body><pre class="r"> <span class="no">B</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">F1</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="no">Nv</span>); <span class="no">B</span></pre></body></html></div>
<pre><code>## $F1
## [1] 1 2 3 4 5 6 7 8</code></pre>
<ul>
<li>Artificial variances are used to generate errors of a normal distribution with 0 mean:</li>
</ul>
<div class="sourceCode" id="cb7"><html><body><pre class="r"> <span class="no">sigma2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="no">Nv</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>)

 <span class="co"># errors matrix</span>
 <span class="no">errors</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">Nv</span>, <span class="no">Ne</span>))
 <span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">Nv</span>){<span class="no">errors</span>[<span class="no">i</span>,] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">Ne</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">sigma2</span>[<span class="no">i</span>]))}</pre></body></html></div>
<ul>
<li>Factor scores (lambda) are generated from a standard normal distribution and the factor loadings (alpha) from a uniform distribution with support ranging from 0.5 to 2. The factor loading direction is generated using signals simulated from the <code>sample</code> function.</li>
</ul>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">lambda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">K</span>*<span class="no">Ne</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">K</span>, <span class="no">Ne</span>)) <span class="co"># Factor scores matrix</span>

<span class="co"># Factor loadings matrix</span>
<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">Nv</span>, <span class="no">K</span>))

<span class="kw">for</span>(<span class="no">k</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">K</span>){<span class="no">alpha</span>[<span class="no">B</span><span class="kw">[[</span><span class="no">k</span>]],<span class="no">k</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(<span class="no">B</span>)[<span class="no">k</span>], <span class="fl">0.5</span>, <span class="fl">2</span>) * <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(<span class="no">B</span>)[<span class="no">k</span>], <span class="kw">replace</span> <span class="kw">=</span> <span class="no">T</span>)}

<span class="no">signals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">F1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span>(<span class="no">alpha</span>)))</pre></body></html></div>
<ul>
<li>Finally, a new artificial data set is produced with the matrix product below:</li>
</ul>
<div class="sourceCode" id="cb9"><html><body><pre class="r"> <span class="no">X</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">alpha</span> <span class="kw">%*%</span> <span class="no">lambda</span> + <span class="no">errors</span>)</pre></body></html></div>
<p>Given that the data set was generated synthetically, we can run <code><a href="../reference/sem.html">bsem::sem</a></code> to check if they retrieve the true values of the parameters used in the generation of the database. We simply use the data argument and the blocks argument to specify the one-factor model:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">unifact</span> <span class="kw">&lt;-</span> <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span>(<span class="no">X</span>, <span class="kw">blocks</span> <span class="kw">=</span> <span class="no">B</span>, <span class="kw">signals</span> <span class="kw">=</span> <span class="no">signals</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p>Descriptive statistics for the posterior factor loadings are showed in the R console inspired on the <code>rstan</code> fashion (based on <code><a href="https://rdrr.io/pkg/rstan/man/monitor.html">rstan::monitor</a></code>). In general, the posterior mean is the Bayesian estimator first choice:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">unifact</span></pre></body></html></div>
<pre><code>## 
## 
## ---
## bsem model:  factorial 
## latent variables (outter model):  1 
## 
## 
##  outer model loadings:
## 
##  F1 
##         mean se_mean     sd    2.5%   97.5% n_eff   Rhat
## var1  0.3489  0.0088 0.2052 -0.0613  0.7421   548 0.9997
## var2  1.0617  0.0162 0.1738  0.7663  1.4275   118 1.0040
## var3 -1.0262  0.0167 0.1740 -1.3848 -0.7176   109 1.0006
## var4 -1.0166  0.0169 0.1835 -1.4122 -0.7082   118 1.0006
## var5  1.0855  0.0162 0.1724  0.7983  1.4599   115 1.0028
## var6 -1.0139  0.0146 0.1792 -1.4057 -0.7021   150 1.0017
## var7  1.0623  0.0159 0.1790  0.7523  1.4332   125 1.0015
## var8 -1.0609  0.0157 0.1733 -1.4429 -0.7538   123 1.0035
## 
## ---</code></pre>
<p>The structural model can be easily viewed with the plotting routine <code><a href="https://rdrr.io/r/graphics/plot.html">bsem::plot</a></code>:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">unifact</span>)</pre></body></html></div>
<div id="htmlwidget-a63bbd1cbe752734cc77" style="width:700px;height:432.632880098888px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a63bbd1cbe752734cc77">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9],"type":[null,null,null,null,null,null,null,null,null],"label":["var1","var2","var3","var4","var5","var6","var7","var8","F1"],"nodes":["var1","var2","var3","var4","var5","var6","var7","var8","F1"],"shape":["box","box","box","box","box","box","box","box","ellipse"],"color":["#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF"],"group":["F1","F1","F1","F1","F1","F1","F1","F1","F1"],"style":["filled","filled","filled","filled","filled","filled","filled","filled","filled"],"fontname":["Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto"],"fontcolor":["white","white","white","white","white","white","white","white","white"],"shadow":[true,true,true,true,true,true,true,true,true]},"edges":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"from":[1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8],"to":[9,9,9,9,9,9,9,9,1,2,3,4,5,6,7,8],"rel":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":[" 0.35"," 1.06","-1.03","-1.02"," 1.09","-1.01"," 1.06","-1.06","0.90","0.20","0.25","0.27","0.15","0.26","0.20","0.20"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"dashes":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"width":[0.7,2.12,2.06,2.04,2.18,2.02,2.12,2.12,1.8,0.4,0.5,0.54,0.3,0.52,0.4,0.4],"font.size":[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":10,"font":{"color":"white"}},"manipulation":{"enabled":false}},"groups":["F1"],"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><p>Moreover, we can compare the posterior factor loadings and the scores with the true values using the <code><a href="../reference/arrayplot.html">bsem::arrayplot</a></code> function. For example:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="kw pkg">gridExtra</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">lambda</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"scores (lambda)"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">unifact</span>$<span class="no">mean_scores</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"scores estimate"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">alpha</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"loadings (alpha)"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">unifact</span>$<span class="no">mean_loadings</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"loadings estimate"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">4</span>), <span class="kw">ncol</span><span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<p><img src="bsem_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>The <code><a href="../reference/arrayplot.html">bsem::arrayplot</a></code> graphs show that the loadings and scores pattern were captured by the model. In order to intensify the contrast between the estimates it may be necessary to increase the number of iterations or the warmup period since this is a model with many parameters. Remember each chains runs in a separate thread, thus, it is recommended specifying a number of cores at least equal to the number of chains. Indeed, from our experience, an increase in the number of iterations raises the runtime but considerably improves the interval and point estimates.</p>
</div>
<div id="bi-factor-cfa" class="section level2">
<h2 class="hasAnchor">
<a href="#bi-factor-cfa" class="anchor"></a>Bi-factor CFA</h2>
<p>The data generated for the uni-factor example, is also used here. This example refers to an application of the bi-factor model ( <a href="https://link.springer.com/article/10.1007/s11336-011-9218-4">Jennrich and Bentler</a>, 2011; <a href="https://link.springer.com/article/10.1007/s11336-011-9218-4">Gibbons and Hedeker</a>, 1992). The ideia behind this application is to show how flexible is SEM. From our generated data we have that variables should manifest only the latent variable <code>F1</code>.</p>
<ul>
<li>The list object <code>B</code> represents each block, indicating which manifest variables are related to each construct. <code>B</code> and, consequently, <code>signals</code> are modified for a bi-factor analysis.</li>
</ul>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">B</span>$<span class="no">G1</span> <span class="kw">&lt;-</span> <span class="fl">1</span>:<span class="fl">3</span>
<span class="no">B</span>$<span class="no">G2</span> <span class="kw">&lt;-</span> <span class="fl">4</span>:<span class="fl">6</span>
<span class="no">B</span>$<span class="no">G3</span> <span class="kw">&lt;-</span> <span class="fl">7</span>:<span class="fl">8</span>

<span class="no">B</span></pre></body></html></div>
<pre><code>## $F1
## [1] 1 2 3 4 5 6 7 8
## 
## $G1
## [1] 1 2 3
## 
## $G2
## [1] 4 5 6
## 
## $G3
## [1] 7 8</code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">signals</span>$<span class="no">G1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">3</span>)
<span class="no">signals</span>$<span class="no">G2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">3</span>)
<span class="no">signals</span>$<span class="no">G3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>,<span class="fl">2</span>)

<span class="no">signals</span></pre></body></html></div>
<pre><code>## $F1
## [1]  1  1 -1 -1  1 -1  1 -1
## 
## $G1
## [1] 1 1 1
## 
## $G2
## [1] 1 1 1
## 
## $G3
## [1] 1 1</code></pre>
<p>Simply use the data argument and the blocks argument to specify the bi-factor model above:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">bifact</span> <span class="kw">&lt;-</span> <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span>(<span class="no">X</span>, <span class="kw">blocks</span> <span class="kw">=</span> <span class="no">B</span>, <span class="kw">signals</span> <span class="kw">=</span> <span class="no">signals</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p>Descriptive statistics for the posterior factor loadings are showed in the result in <code>rstan</code> fashion:</p>
<p>The structural model is displayed using <code><a href="https://rdrr.io/r/graphics/plot.html">bsem::plot</a></code>:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">bifact</span>, <span class="kw">layout</span> <span class="kw">=</span> <span class="st">'nicely'</span>)</pre></body></html></div>
<div id="htmlwidget-4da3a128e470d30391e1" style="width:700px;height:432.632880098888px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4da3a128e470d30391e1">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12],"type":[null,null,null,null,null,null,null,null,null,null,null,null],"label":["var1","var2","var3","var4","var5","var6","var7","var8","F1","G1","G2","G3"],"nodes":["var1","var2","var3","var4","var5","var6","var7","var8","F1","G1","G2","G3"],"shape":["box","box","box","box","box","box","box","box","ellipse","ellipse","ellipse","ellipse"],"color":["#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#440154FF","#3B528BFF","#3B528BFF","#3B528BFF","#21908CFF"],"group":["F1","F1","F1","F1","F1","F1","F1","F1","G1","G1","G1","G2"],"style":["filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled"],"fontname":["Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto"],"fontcolor":["white","white","white","white","white","white","white","white","white","white","white","white"],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true]},"edges":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],"from":[1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8],"to":[9,9,9,9,9,9,9,9,10,10,10,11,11,11,12,12,1,2,3,4,5,6,7,8],"rel":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":[" 0.37"," 1.10","-1.06","-1.05"," 1.13","-1.05"," 1.10","-1.10","-0.03","-0.02"," 0.01"," 0.04"," 0.00"," 0.00"," 0.00"," 0.00","0.68","0.19","0.25","0.25","0.16","0.25","0.19","0.20"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"dashes":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"width":[0.74,2.2,2.12,2.1,2.26,2.1,2.2,2.2,0.06,0.04,0.02,0.08,0,0,0,0,1.36,0.38,0.5,0.5,0.32,0.5,0.38,0.4],"font.size":[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":10,"font":{"color":"white"}},"manipulation":{"enabled":false}},"groups":["F1","G1","G2"],"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><p>Compare the posterior factor loadings and the scores with the true values using the <code><a href="../reference/arrayplot.html">bsem::arrayplot</a></code> function:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="kw pkg">gridExtra</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">lambda</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"scores (lambda)"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">bifact</span>$<span class="no">mean_scores</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"scores estimate"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">alpha</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"loadings (alpha)"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">bifact</span>$<span class="no">mean_loadings</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"loadings estimate"</span>, -<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">4</span>), <span class="kw">ncol</span><span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<p><img src="bsem_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>The <code><a href="../reference/arrayplot.html">bsem::arrayplot</a></code> graphs show that the loadings and scores pattern were captured by the model. An increase in the number of iterations or the warmup period may improve the point estimates. As expected, the outcome estimates evidance a one-factor model, which means other latent variables would not be helpful in explaining this data (as we know from the generation). This conclusion can also be achieved looking at the diagram.`</p>
</div>
<div id="multi-factor-cfa-uncorrelated" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-factor-cfa-uncorrelated" class="anchor"></a>Multi-factor CFA (uncorrelated)</h2>
<p>Artificial data sets are part of the package content as <em>.rdata</em> files. Therefore, they can be retrieved using the specific “character” name within the <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> argument. The <code>set1</code> and<code>set2</code> examples were generated using routines similar to those shown in the uni-factor example.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">'bsem'</span>)</pre></body></html></div>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"set1"</span>)</pre></body></html></div>
<p>The implemented routines allow partial and full uncorrelated confirmatory factor analysis (CFA). So, at least one variable must be chosen to express each construct before running into the analysis. In other words, the user needs to specify at least one manifest variable that lead each block. In this way, partial EFA/CFA assists the researcher in evidencing the possible structures to be tested in a conceptual (full) CFA later on.</p>
<ul>
<li>The list of blocks represent that indicates only the manifest variables related to each construct:</li>
</ul>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">set1</span>$<span class="no">blocks</span></pre></body></html></div>
<pre><code>## [[1]]
## [1] 1 2 3
## 
## [[2]]
## [1] 4 5
## 
## [[3]]
## [1] 6 7</code></pre>
<ul>
<li>Descriptive statistics for the posterior factor loadings are showed in the result in <code>rstan</code> fashion (based on <code><a href="https://rdrr.io/pkg/rstan/man/monitor.html">rstan::monitor</a></code>):</li>
</ul>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">multifact</span> <span class="kw">&lt;-</span> <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">set1</span>$<span class="no">set</span>, <span class="kw">blocks</span> <span class="kw">=</span> <span class="no">set1</span>$<span class="no">blocks</span>, <span class="kw">chains</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">scaled</span> <span class="kw">=</span> <span class="no">F</span>)</pre></body></html></div>
<ul>
<li>The structural model can be easily viewed with the plotting routine <code><a href="https://rdrr.io/r/graphics/plot.html">bsem::plot</a></code>:</li>
</ul>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">multifact</span>)</pre></body></html></div>
<div id="htmlwidget-c1de475e1f4acd946cf0" style="width:700px;height:432.632880098888px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-c1de475e1f4acd946cf0">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10],"type":[null,null,null,null,null,null,null,null,null,null],"label":["var1","var2","var3","var4","var5","var6","var7","latent1","latent2","latent3"],"nodes":["var1","var2","var3","var4","var5","var6","var7","latent1","latent2","latent3"],"shape":["box","box","box","box","box","box","box","ellipse","ellipse","ellipse"],"color":["#440154FF","#440154FF","#440154FF","#31688EFF","#31688EFF","#35B779FF","#35B779FF","#440154FF","#31688EFF","#35B779FF"],"group":["latent1","latent1","latent1","latent2","latent2","latent3","latent3","latent1","latent2","latent3"],"style":["filled","filled","filled","filled","filled","filled","filled","filled","filled","filled"],"fontname":["Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto"],"fontcolor":["white","white","white","white","white","white","white","white","white","white"],"shadow":[true,true,true,true,true,true,true,true,true,true]},"edges":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14],"from":[1,2,3,4,5,6,7,1,2,3,4,5,6,7],"to":[8,8,8,9,9,10,10,1,2,3,4,5,6,7],"rel":[null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":[" 1.12"," 1.45","-0.73","-1.60","-1.23"," 1.15"," 1.69","0.42","0.90","0.44","0.21","0.29","0.43","0.43"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"dashes":[false,false,false,false,false,false,false,false,false,false,false,false,false,false],"width":[2.24,2.9,1.46,3.2,2.46,2.3,3.38,0.84,1.8,0.88,0.42,0.58,0.86,0.86],"font.size":[15,15,15,15,15,15,15,15,15,15,15,15,15,15]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":10,"font":{"color":"white"}},"manipulation":{"enabled":false}},"groups":["latent1","latent2","latent3"],"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="kw pkg">gridExtra</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(
  <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">multifact</span>$<span class="no">mean_scores</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'estimates'</span>,  <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">2</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">set1</span>$<span class="no">real</span>$<span class="no">lambda</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'lambda (scores)'</span>, <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">2</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">multifact</span>$<span class="no">mean_loadings</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'estimates'</span>,
                  <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">2</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">set1</span>$<span class="no">real</span>$<span class="no">alpha</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'alpha (loadings)'</span>,  <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">2</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">2</span>),
  <span class="kw">layout_matrix</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">4</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<p><img src="bsem_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>The state-of-art <code>bsem</code> package only provides estimates for uncorrelated SEMs. The recursive arrows indicate the estimate for each error variance. From this example, we found that the estimates pattern are tighly close to the true values of the parameters even when the signals are not passed. Also, we have observed that the part of the analysis is intended to confirm the predefined constructs CFA (first loadings matrix lines) and the other is intended to express which variable can compose a later full CFA.</p>
</div>
<div id="sem" class="section level2">
<h2 class="hasAnchor">
<a href="#sem" class="anchor"></a>SEM</h2>
<p>In the last example, not all variables were used in the formulation of predefined constructs. In many applications, with the help of technical knowledge, it is possible to establish relationships between all variables in the data set and the constructs under study. This case characterizes the confirmatory factor analisys (CFA). Besides that, we can also verify linear relationships between latent variables. The blocks can be passed as named lists and the database with colnames and rownames. For example, for set2 we have:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">'bsem'</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"set2"</span>)</pre></body></html></div>
<p>It is worth mentioning that the paths are named with block names. There are two ways to define the model: 1) the blocks and the data set are not named previously (internally named); 2) named blocks and named paths are passed to their respective arguments; otherwise should generate an error.</p>
<p>The data argument, the blocks and the paths arguments should specify ta full uncorrelated SEM model. The blocks represent the manifest variables that form each construct while the paths represent the linear relationships between the latent variables:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">sem</span> <span class="kw">&lt;-</span> <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">set2</span>$<span class="no">set</span>, <span class="kw">blocks</span> <span class="kw">=</span> <span class="no">set2</span>$<span class="no">blocks</span>,
                     <span class="kw">paths</span> <span class="kw">=</span> <span class="no">set2</span>$<span class="no">paths</span>, <span class="kw">signals</span> <span class="kw">=</span> <span class="no">set2</span>$<span class="no">signals</span>,
                 <span class="kw">chains</span> <span class="kw">=</span><span class="fl">1</span>, <span class="kw">scaled</span> <span class="kw">=</span> <span class="no">F</span>)</pre></body></html></div>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">sem</span>)</pre></body></html></div>
<div id="htmlwidget-79f30dfeb0d8fac0aa08" style="width:700px;height:432.632880098888px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-79f30dfeb0d8fac0aa08">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],"type":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["V1","V2","V3","V4","V5","V6","V7","V8","V9","V10","V11","V12","V13","V14","V15","V16","V17","V18","V19","V20","V21","F1","F2","F3","F4","F5"],"nodes":["V1","V2","V3","V4","V5","V6","V7","V8","V9","V10","V11","V12","V13","V14","V15","V16","V17","V18","V19","V20","V21","F1","F2","F3","F4","F5"],"shape":["box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","box","ellipse","ellipse","ellipse","ellipse","ellipse"],"color":["#440154FF","#414487FF","#414487FF","#414487FF","#414487FF","#414487FF","#414487FF","#2A788EFF","#2A788EFF","#2A788EFF","#22A884FF","#22A884FF","#22A884FF","#22A884FF","#22A884FF","#22A884FF","#7AD151FF","#7AD151FF","#7AD151FF","#7AD151FF","#7AD151FF","#440154FF","#414487FF","#2A788EFF","#22A884FF","#7AD151FF"],"group":["F1","F2","F2","F2","F2","F2","F2","F3","F3","F3","F4","F4","F4","F4","F4","F4","F5","F5","F5","F5","F5","F1","F2","F3","F4","F5"],"style":["filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled","filled"],"fontname":["Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto","Roboto"],"fontcolor":["white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"edges":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46],"from":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,25,26,26,25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"to":[22,23,23,23,23,23,23,24,24,24,25,25,25,25,25,25,26,26,26,26,26,22,23,24,24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"rel":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":[" 1.49"," 1.47","-1.05"," 1.63"," 1.46"," 0.71","-1.50"," 0.60","-1.23"," 1.60"," 1.76","-1.32","-2.30","-1.29","-1.17"," 2.22","-2.42"," 1.50","-1.62","-1.42","-0.84"," 1.28","-0.56"," 0.44","-1.16","0.75","0.46","0.48","0.78","0.90","0.52","0.27","0.69","0.54","0.45","0.77","0.85","0.48","0.19","0.34","0.52","0.74","0.44","0.59","0.33","0.26"],"smooth":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"dashes":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,true,true,true,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"width":[2.98,2.94,2.1,3.26,2.92,1.42,3,1.2,2.46,3.2,3.52,2.64,4.6,2.58,2.34,4.44,4.84,3,3.24,2.84,1.68,2.56,1.12,0.88,2.32,1.5,0.92,0.96,1.56,1.8,1.04,0.54,1.38,1.08,0.9,1.54,1.7,0.96,0.38,0.68,1.04,1.48,0.88,1.18,0.66,0.52],"font.size":[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":10,"font":{"color":"white"}},"manipulation":{"enabled":false}},"groups":["F1","F2","F3","F4","F5"],"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="kw pkg">gridExtra</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">sem</span>$<span class="no">mean_scores</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'estimates'</span>, <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">4</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">4</span>),
                      <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">set2</span>$<span class="no">real</span>$<span class="no">lambda</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'lambda (scores)'</span>, <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">4</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">4</span>),
                      <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">sem</span>$<span class="no">mean_loadings</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'estimates'</span>, <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">4</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">4</span>),
                      <span class="kw pkg">bsem</span><span class="kw ns">::</span><span class="fu"><a href="../reference/arrayplot.html">arrayplot</a></span>(<span class="no">set2</span>$<span class="no">real</span>$<span class="no">alpha</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">'alpha (loadings)'</span>, <span class="kw">mini</span> <span class="kw">=</span> -<span class="fl">4</span>, <span class="kw">maxi</span> <span class="kw">=</span> <span class="fl">4</span>),
                      <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">4</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<p><img src="bsem_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>Again, we found that the estimates pattern are tighly close to the true values of the parameters. This examples highlights a complete confirmatory SEM analysis. The regression coefficients estimates are:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="kw pkg">pander</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">sem</span>$<span class="no">coef</span>, <span class="no">set2</span>$<span class="no">real</span>$<span class="no">beta</span>))</pre></body></html></div>
<table class="table">
<colgroup>
<col width="19%">
<col width="13%">
<col width="9%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><strong>beta[1]</strong></td>
<td align="center">1.276</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center"><strong>beta[2]</strong></td>
<td align="center">-0.5618</td>
<td align="center">-0.5</td>
</tr>
<tr class="odd">
<td align="center"><strong>beta[3]</strong></td>
<td align="center">0.4374</td>
<td align="center">-1.5</td>
</tr>
<tr class="even">
<td align="center"><strong>beta[4]</strong></td>
<td align="center">-1.163</td>
<td align="center">0.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="graphical-posterior-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#graphical-posterior-analysis" class="anchor"></a>Graphical posterior analysis</h1>
<p>All content exposed in the examples can be retrived by the user folowing the comand lines above. Although, keep in mind that we must check posterior statistics in order to assess whether the estimates are good to describe the proposed CFA or SEM model.</p>
<div id="interval-estimate" class="section level2">
<h2 class="hasAnchor">
<a href="#interval-estimate" class="anchor"></a>Interval estimate</h2>
<p>Two types of intervals can be obtained:</p>
<div id="hpd-interval" class="section level3">
<h3 class="hasAnchor">
<a href="#hpd-interval" class="anchor"></a>HPD interval</h3>
<ul>
<li>The narrowest (highest posterior density - HPD) credibility interval can be retrieved using <code>.$credint</code>. We have computed HPD intervals fo the factor loadings (alpha), scores (lambda), and regression coefficients (beta).</li>
</ul>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">sem</span>$<span class="no">credint</span>)</pre></body></html></div>
<pre><code>## [1] "loadings" "scores"   "var"      "coef"</code></pre>
<ul>
<li>This data can be used to plot interval estimates using two packages, <code>ggplot2</code> and <code>tidybayes</code>:</li>
</ul>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"tidybayes"</span>)</pre></body></html></div>
<ul>
<li>
<code>dt</code> data.frame object has the mean loadings and the HPD interval lower and upper limits (<code>ll</code> and <code>lu</code>):</li>
</ul>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">dt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">li</span> <span class="kw">=</span> <span class="no">sem</span>$<span class="no">credint</span>$<span class="no">loadings</span>[,<span class="fl">1</span>],
                 <span class="kw">lu</span> <span class="kw">=</span> <span class="no">sem</span>$<span class="no">credint</span>$<span class="no">loadings</span>[,<span class="fl">2</span>],
                 <span class="kw">m</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">sem</span>$<span class="no">mean_loadings</span>))</pre></body></html></div>
<ul>
<li>
<code>lnames</code> and <code>snames</code> are used to find the loadings of the conceptual model (those that might not equal zero).</li>
</ul>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">lnames</span> <span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sem</span>$<span class="no">mean_loadings</span>)
<span class="no">snames</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">sem</span>$<span class="no">mean_scores</span>)</pre></body></html></div>
<ul>
<li>
<code>find</code> help us finding these values:</li>
</ul>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">find</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"alpha["</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">lnames</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">sem</span>$<span class="no">blocks</span>)), <span class="st">","</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">sem</span>$<span class="no">blocks</span>), <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(<span class="no">sem</span>$<span class="no">blocks</span>)), <span class="st">"]"</span>)

<span class="no">dt</span> <span class="kw">&lt;-</span> <span class="no">dt</span>[<span class="no">find</span>,]</pre></body></html></div>
<ul>
<li>One of the options to plot the loadings HPD intervals chart is:</li>
</ul>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">find</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">m</span>, <span class="kw">xmin</span> <span class="kw">=</span> <span class="no">li</span>, <span class="kw">xmax</span> <span class="kw">=</span> <span class="no">lu</span>), <span class="kw">data</span> <span class="kw">=</span> <span class="no">dt</span>) +
  <span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/geom_pointinterval.html">geom_pointintervalh</a></span>() + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Latent variable"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">sem</span>$<span class="no">mean_loadings</span>)[<span class="fl">3</span>]),
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Highest posterior density interval"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"variable"</span>)</pre></body></html></div>
<p><img src="bsem_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<p>In the SEM example above, all intervals regarding the loading estimates from the conceptual relationships do not include zero.</p>
</div>
<div id="equal-tails-interval" class="section level3">
<h3 class="hasAnchor">
<a href="#equal-tails-interval" class="anchor"></a>Equal tails interval</h3>
<p>Alternatively, it is possible to access equal tails credibility intevals using the <code>bayesplot</code> package:</p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"bayesplot"</span>)</pre></body></html></div>
<ul>
<li>
<code>find</code> help us finding the loading values that have been previously determined to estimate the latent scores:</li>
</ul>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">find</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"alpha["</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">lnames</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">sem</span>$<span class="no">blocks</span>)), <span class="st">","</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">sem</span>$<span class="no">blocks</span>), <span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(<span class="no">sem</span>$<span class="no">blocks</span>)), <span class="st">"]"</span>)

<span class="no">dt</span> <span class="kw">&lt;-</span> <span class="no">dt</span>[<span class="no">find</span>,]</pre></body></html></div>
<ul>
<li>The equal tails intervals are:</li>
</ul>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="kw pkg">gridExtra</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span>(<span class="no">sem</span>$<span class="no">posterior</span>$<span class="no">alpha</span>[,,<span class="no">find</span>]),
                        <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_intervals</a></span>(<span class="no">sem</span>$<span class="no">posterior</span>$<span class="no">alpha</span>[,,<span class="no">find</span>]),
                        <span class="kw">layout_matrix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>))</pre></body></html></div>
<p><img src="bsem_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>In addition to the possibilities for intervals, other <code>mcmc_.</code> type graphs are highly recommended, several options include histograms, violin plots, pair plots and others.</p>
</div>
</div>
</div>
<div id="descriptives" class="section level1">
<h1 class="hasAnchor">
<a href="#descriptives" class="anchor"></a>Descriptives</h1>
<ul>
<li>The <code><a href="https://rdrr.io/r/base/summary.html">bsem::summary</a></code> routine prints descriptive statistics to the R console:</li>
</ul>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">sem</span>)</pre></body></html></div>
<pre><code>## 
## 
## ---
## bsem model:  sem 
## latent variables (outter model):  5 
## regressions (inner model):  3 
## 
## 
##  outer model loadings:
## 
##  F1 
##    mean se_mean      sd    2.5%   97.5%   n_eff    Rhat 
##  1.4859  0.0370  0.3387  0.8140  2.2152 84.0000  1.0110 
## 
##  F2 
##       mean se_mean     sd    2.5%   97.5% n_eff  Rhat
## V2  1.4656  0.0178 0.2320  1.0584  1.9621   174 1.007
## V3 -1.0529  0.0128 0.1933 -1.4384 -0.6853   229 1.003
## V4  1.6252  0.0188 0.2696  1.1428  2.2105   205 1.003
## V5  1.4573  0.0176 0.2638  0.9874  2.0058   223 1.003
## V6  0.7119  0.0084 0.1729  0.4188  1.0659   428 1.001
## V7 -1.5045  0.0177 0.2343 -1.9972 -1.0935   175 1.003
## 
##  F3 
##        mean se_mean     sd    2.5%   97.5% n_eff  Rhat
## V8   0.6001  0.0073 0.1420  0.3448  0.8888   376 1.004
## V9  -1.2320  0.0141 0.2088 -1.6586 -0.8659   220 1.004
## V10  1.6016  0.0191 0.2497  1.1684  2.1347   171 1.005
## 
##  F4 
##       mean se_mean     sd   2.5%   97.5% n_eff  Rhat
## V11  1.761  0.0232 0.2929  1.254  2.3943   172 1.017
## V12 -1.317  0.0174 0.2537 -1.864 -0.8837   231 1.017
## V13 -2.300  0.0289 0.3340 -2.999 -1.7407   143 1.020
## V14 -1.290  0.0160 0.1925 -1.720 -0.9632   152 1.017
## V15 -1.174  0.0162 0.1966 -1.595 -0.8314   163 1.023
## V16  2.224  0.0283 0.3233  1.681  2.9038   141 1.023
## 
##  F5 
##        mean se_mean     sd   2.5%   97.5% n_eff  Rhat
## V17 -2.4238  0.0375 0.3829 -3.330 -1.8132   104 1.005
## V18  1.5013  0.0233 0.2476  1.106  2.0761   113 1.008
## V19 -1.6153  0.0244 0.2757 -2.243 -1.1716   128 1.002
## V20 -1.4198  0.0221 0.2370 -1.929 -1.0265   115 1.005
## V21 -0.8431  0.0143 0.1618 -1.224 -0.5833   129 1.004
## 
## ---
## 
##  variances:
##           mean se_mean     sd   2.5%  97.5% n_eff   Rhat
## var[1]  0.7508  0.0663 0.6182 0.1843 2.2981    89 1.0047
## var[2]  0.4551  0.0061 0.1414 0.2454 0.7726   531 0.9991
## var[3]  0.4753  0.0053 0.1368 0.2758 0.8218   658 0.9998
## var[4]  0.7801  0.0096 0.2300 0.4269 1.3211   590 1.0054
## var[5]  0.8952  0.0104 0.2446 0.5248 1.4531   565 1.0012
## var[6]  0.5214  0.0053 0.1427 0.3040 0.8554   716 1.0014
## var[7]  0.2658  0.0044 0.0951 0.1258 0.5030   476 1.0007
## var[8]  0.6940  0.0069 0.1817 0.4176 1.1141   682 0.9994
## var[9]  0.5445  0.0088 0.1964 0.2410 0.9796   501 1.0004
## var[10] 0.4469  0.0129 0.2161 0.1692 1.0144   280 1.0009
## var[11] 0.7749  0.0094 0.2268 0.4434 1.3395   571 1.0000
## var[12] 0.8511  0.0135 0.2610 0.5050 1.4714   371 1.0011
## var[13] 0.4780  0.0063 0.1547 0.2478 0.8308   601 0.9992
## var[14] 0.1943  0.0024 0.0565 0.1124 0.3273   547 1.0011
## var[15] 0.3414  0.0042 0.1019 0.1954 0.5825   606 1.0030
## var[16] 0.5227  0.0059 0.1583 0.2596 0.9215   723 0.9992
## var[17] 0.7361  0.0130 0.2630 0.3583 1.4447   419 1.0061
## var[18] 0.4424  0.0058 0.1367 0.2400 0.7842   560 1.0026
## var[19] 0.5863  0.0099 0.1777 0.3204 1.0309   336 1.0034
## var[20] 0.3275  0.0039 0.0993 0.1725 0.5634   659 1.0002
## var[21] 0.2586  0.0032 0.0743 0.1536 0.4361   545 1.0007
## 
## ---
## 
##  inner model regression coefficients:
## 
##  F1 
##    mean se_mean      sd    2.5%   97.5%   n_eff    Rhat 
##  1.2758  0.0588  0.4235  0.6032  2.2497 57.0000  1.0208 
## 
##  F2 
##     mean  se_mean       sd     2.5%    97.5%    n_eff     Rhat 
##  -0.5618   0.0120   0.2270  -1.0706  -0.1668 364.0000   1.0023 
## 
##  F3 
##       mean se_mean     sd    2.5%   97.5% n_eff   Rhat
## F5  0.4374  0.0095 0.2243  0.0084  0.8673   570 1.0033
## F4 -1.1631  0.0201 0.2974 -1.8052 -0.6173   220 0.9995
## 
## 
## 
## Head Rhat:
##  alpha[18,2]  alpha[15,4]  alpha[16,4] lambda[4,20] lambda[4,23]      beta[1] 
##        1.031        1.023        1.023        1.022        1.021        1.021 
## 
## Tail Rhat:
##  alpha[13,3]   alpha[4,3]    sigma2[2] lambda[2,21] lambda[1,29]  alpha[11,1] 
##       0.9991       0.9991       0.9991       0.9991       0.9991       0.9990 
## 
## median PVTE:  80.15 
## SQT: 1566 SQE: 1885 AFR2: 16.92% 
## 
## ---</code></pre>
<p>The effective sample size <code>n_eff</code> gives an estimate of the independent draws from the posterior distribution, and <code>Rhat</code> referred to as the potential scale reduction statistic, is one of the useful ways to monitor whether a chain has converged to the equilibrium distribution. This statistic measures the ratio between the average variation of the samples within each chain and the variation of the combined samples in the chains; if the chains have not converged to a common region, this statistic will be greater than one.</p>
<ul>
<li>It is worth noting that, one can have acces to all the information provided by the <code>Stan</code> output object using the <code>.$stanfit</code> command:</li>
</ul>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">sem</span>$<span class="no">stanfit</span>)</pre></body></html></div>
<pre><code>## [1] "stanfit"
## attr(,"package")
## [1] "rstan"</code></pre>
<p>In particular, one can have access to built-in plot functions and even to a <code>shiny</code> app (details in <a href="https://shiny.rstudio.com/">https://shiny.rstudio.com/</a> developed by <code>Stan</code> developer’s team</p>
<p>For the shiny app run:</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="kw pkg">shinystan</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/shinystan/man/launch_shinystan.html">launch_shinystan</a></span>(<span class="no">sem</span>$<span class="no">stanfit</span>)</pre></body></html></div>
<p>A crucial difference in obtaining the same statistics printed by the <code><a href="https://rdrr.io/r/base/summary.html">bsem::summary</a></code> function is the use of the signals argument in the <code><a href="../reference/sem.html">bsem::sem</a></code> routine. The signal specification, (-1 or 1) for each of the factor loadings, forces the initial values of each chain to have the same direction and, naturally, these chains converge to nearby regions. Otherwise, the signal of some factor loading chain may be opposite as a consequece of random initialization. In order to circumveit this issue, the package automatically transform posterior chains using simple <code>for</code> loops and <code>if</code> statements to recalculate the descriptives using <code><a href="https://rdrr.io/pkg/rstan/man/monitor.html">rstan::monitor</a></code>.</p>
<ul>
<li>The monitoring result is returned with <code>.$</code> :</li>
</ul>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">sem</span>$<span class="no">stats</span>, <span class="fl">2</span>)</pre></body></html></div>
<pre><code>##                     mean      se_mean          sd        2.5%          25%
## alpha[1,1]  1.4858510226 0.0370262589 0.338650475  0.81404849  1.269334855
## alpha[2,1] -0.0004997945 0.0003192344 0.009873391 -0.02006834 -0.007483517
##                      50%         75%      97.5% n_eff      Rhat valid
## alpha[1,1]  1.4761719218 1.690830020 2.21515053    84 1.0110205     1
## alpha[2,1] -0.0003960244 0.006217186 0.01977989   947 0.9994626     1
##                     Q5           Q50        Q95    MCSE_Q2.5     MCSE_Q25
## alpha[1,1]  0.95946739  1.4761719218 2.05542866 0.1309693240 0.0420073786
## alpha[2,1] -0.01676949 -0.0003960244 0.01573315 0.0008653601 0.0006297068
##                MCSE_Q50     MCSE_Q75   MCSE_Q97.5      MCSE_SD Bulk_ESS
## alpha[1,1] 0.0333853586 0.0370113503 0.0531854185 0.0262733497       84
## alpha[2,1] 0.0003104586 0.0003170929 0.0009815365 0.0003265722      965
##            Tail_ESS
## alpha[1,1]       64
## alpha[2,1]      596</code></pre>
<p>The next code chunk shows the code for trace and density plotting using the <code>bayesplot</code> package. The graphs show unimodal posterior densities and well behaved chains with good mixing, this is a good behavior indication.</p>
</div>
<div id="remarks" class="section level1">
<h1 class="hasAnchor">
<a href="#remarks" class="anchor"></a>Remarks</h1>
<p>The content of this vignette introduces the <code>bsem</code> package. Here, the analysis was dedicated to illustrating, in practice, the commands implemented in the proposed package spsurv. We still have work to do to improve and update this tool, however, the present version is ready for the main statistical study in the field of survival analysis. The routines presented in this dissertation are unprecedented. Many efforts with regard to the instruction the routines documentation were carried out concurrently with the spsurv package implementation. This document is part of the content submitted to <a href="https://cran.r-project.org/">CRAN</a>. The package is also in public use and is available at the github development platform, the link is: <a href="https://github.com/rvpanaro/spsurv" class="uri">https://github.com/rvpanaro/spsurv</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Renato Panaro, Vinícius Mayrink.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '',
    indexName: 'bsem',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
